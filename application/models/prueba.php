<?php
require_once('base.php');
class Prueba extends Base {

	public function __construct()
	{
		parent::__construct();    
	}
    
	function actualiza_precios()
	{
		$items=array(
			'7337320',
			'9769480',
			'01347991',
			'05132001',
			'05149440',
			'05250780',
			'05512320',
			'05513290',
			'05588951',
			'05626050',
			'05647120',
			'05715340',
			'05715590',
			'06062750',
			'06169050',
			'06228731',
			'06228731',
			'06228731',
			'06264790',
			'06264790',
			'06264790',
			'06485741',
			'06611140',
			'06611170',
			'06654270',
			'06677490',
			'06792850',
			'06792870',
			'06808120',
			'06808130',
			'06808140',
			'06808150',
			'06808880',
			'06848120',
			'06848150',
			'06848160',
			'06875440',
			'06878300',
			'06932100',
			'06932200',
			'06932280',
			'06932700',
			'07006550',
			'07006580',
			'07006640',
			'07014790',
			'07018050',
			'07018420',
			'07074762',
			'07080630',
			'07080670',
			'07094120',
			'07094140',
			'07094150',
			'07121520',
			'07121520',
			'07121520',
			'07121770',
			'07132710',
			'07138120',
			'07141840',
			'07141850',
			'07165640',
			'07165710',
			'07165730',
			'07165740',
			'07165760',
			'07182170',
			'07182180',
			'07182380',
			'07182430',
			'07182440',
			'07182450',
			'07182480',
			'07182510',
			'07182520',
			'07182520',
			'07182550',
			'07189940',
			'07207240',
			'07207310',
			'07214610',
			'07222730',
			'07226140',
			'07226150',
			'07226160',
			'07226170',
			'07252100',
			'07252280',
			'07252850',
			'07253820',
			'07294230',
			'07314260',
			'07314290',
			'07331640',
			'07334670',
			'07334680',
			'07342880',
			'07342890',
			'07374330',
			'07431190',
			'07431200',
			'07476110',
			'07505380',
			'07547500',
			'07547520',
			'07547560',
			'07571920',
			'07582020',
			'07616440',
			'07717170',
			'07732610',
			'07821760',
			'07867910',
			'07867920',
			'07890090',
			'07916600',
			'07967780',
			'07984460',
			'07984480',
			'07993340',
			'07993360',
			'07993370',
			'07997690',
			'09042720',
			'09060330',
			'09063520',
			'09102880',
			'09137860',
			'09139930',
			'09153490',
			'09153500',
			'09183560',
			'09221320',
			'09221330',
			'09233530',
			'09257630',
			'09349770',
			'09349780',
			'09349790',
			'09385900',
			'09385910',
			'09454850',
			'09454930',
			'09455070',
			'09455090',
			'09460110',
			'09660020',
			'09660040',
			'09660940',
			'09682270',
			'09682300',
			'09682390',
			'09682430',
			'09682560',
			'09685120',
			'09714230',
			'09714250',
			'09739970',
			'09767500',
			'09767510',
			'09769450',
			'09769460',
			'09769500',
			'09769640',
			'09769650',
			'09828390',
			'09828400'
		);
		
		$precios=array(
			'2155.17',
			'90431.03',
			'163.79',
			'146.55',
			'1293.10',
			'1017.24',
			'258.62',
			'948.28',
			'215.52',
			'258.62',
			'19741.38',
			'2500.00',
			'3362.07',
			'36982.76',
			'36982.76',
			'1637.93',
			'1637.93',
			'1637.93',
			'2500.00',
			'2500.00',
			'2500.00',
			'1293.10',
			'25775.86',
			'31810.34',
			'2155.17',
			'55086.21',
			'41293.10',
			'41293.10',
			'189.66',
			'189.66',
			'250.00',
			'189.66',
			'241.38',
			'86.21',
			'137.93',
			'146.55',
			'55948.28',
			'55086.21',
			'137844.83',
			'94741.38',
			'107672.41',
			'163706.90',
			'99.14',
			'86.21',
			'198.28',
			'150.86',
			'241.38',
			'241.38',
			'2155.17',
			'49051.72',
			'56810.34',
			'5948.28',
			'5086.21',
			'5948.28',
			'7758.62',
			'7758.62',
			'7758.62',
			'60258.62',
			'258.62',
			'27500.00',
			'18879.31',
			'18879.31',
			'18879.31',
			'29224.14',
			'37844.83',
			'24051.72',
			'46465.52',
			'21465.52',
			'21465.52',
			'2155.17',
			'3017.24',
			'2500.00',
			'3017.24',
			'3017.24',
			'9396.55',
			'11120.69',
			'11206.90',
			'14655.17',
			'775.86',
			'297.41',
			'103.45',
			'58534.48',
			'28784.48',
			'387.93',
			'387.93',
			'560.34',
			'560.34',
			'258.62',
			'301.72',
			'853.45',
			'767.24',
			'1637.93',
			'50775.86',
			'25775.86',
			'155.17',
			'28448.28',
			'21465.52',
			'6465.52',
			'6465.52',
			'2155.17',
			'10344.83',
			'7327.59',
			'6465.52',
			'103362.07',
			'86120.69',
			'116293.10',
			'111982.76',
			'6465.52',
			'3016.38',
			'258.62',
			'4224.14',
			'39568.97',
			'33534.48',
			'3188.79',
			'3447.41',
			'34396.55',
			'63706.90',
			'48189.66',
			'21465.52',
			'21465.52',
			'24051.72',
			'24913.79',
			'17155.17',
			'25775.86',
			'77.59',
			'1715.52',
			'6810.34',
			'1293.10',
			'2155.17',
			'6033.62',
			'219.83',
			'232.76',
			'5602.59',
			'6810.34',
			'6810.34',
			'5861.21',
			'18879.31',
			'6464.66',
			'6723.28',
			'6895.69',
			'732.76',
			'818.97',
			'29224.14',
			'28362.07',
			'31810.34',
			'30086.21',
			'28362.07',
			'90431.03',
			'55948.28',
			'64568.97',
			'51637.93',
			'51637.93',
			'77500.00',
			'77500.00',
			'17155.17',
			'25775.86',
			'77500.00',
			'25775.86',
			'17155.17',
			'6810.34',
			'6810.34',
			'77500.00',
			'77500.00',
			'90431.03',
			'55948.28',
			'55948.28',
			'2155.17',
			'2155.17'
		);
		
		$items_precios=array();
		$i=0;
		foreach($items as $item)
		{
			$items_precios[$item]=$precios[$i];
			$i++;
		}
		
		//debug($items_precios);
		
		$this->db->select('item, modelo, nombre, precio');
		$res=$this->db->get('productos')->result_array();
		
		$productos=array();
		foreach($res as $p=>$v)
			$productos[$v['item']]=$v;
		
		$this->db->select('item, modelo, nombre, precio');
		$res=$this->db->get('accesorios')->result_array();
		
		foreach($res as $p=>$v)
			$productos[$v['item']]=$v;
		
		foreach($productos as &$p)
		{
			
			if(in_array($p['item'],$items))
				$p['existe']='EXISTE';
			else 
				$p['existe']='NO EXISTE EN EXCEL';
			
			if($items_precios[$p['item']]=$p['precio'])
				$p['modificado']='NO MODIFICADO';
			else 
				$p['modificado']='MODIFICADO';
			
		}
		
		//debug($productos);
		$no_existentes=0;
		foreach($items as $item)
		{
			$existe=FALSE;
			foreach($productos as $p)
			{
				if($item==$p['item'])
					$existe=TRUE;
			}
			
			if(!$existe)
			{
				$productos[$item]=array('item'=>$item, 'modelo'=>NULL,'nombre'=>NULL,'precio'=>$items_precios[$item],'existe'=>'NO EXISTE EN BASE DE DATOS','modificado'=>'NO MODIFICADO');
				$no_existentes++;
			}
				
		}
		
		//debug($productos);debug($no_existentes);
		return $productos;
		
	}
       
}